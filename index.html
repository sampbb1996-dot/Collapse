<!doctype html><html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<style>
html,body{margin:0;height:100%;background:#000;overflow:hidden;touch-action:none;-webkit-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent}
#dbg{position:fixed;inset:auto 0 0 0;max-height:45%;overflow:auto;background:rgba(0,0,0,.7);color:#0f0;font:12px/1.3 ui-monospace;white-space:pre-wrap;padding:10px}
#overlay{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;color:#888;font-family:system-ui}
canvas{display:block}
</style>
</head><body>
<div id="overlay">tap to begin</div>
<canvas id="c"></canvas>
<pre id="dbg"></pre>
<script>
const dbg=t=>{const e=document.getElementById('dbg'); e.textContent+=(t+"\n");};
window.onerror=(m,s,l,c,err)=>dbg("ERR: "+m+" @"+l+":"+c);
window.onunhandledrejection=e=>dbg("REJECT: "+(e.reason?.message||e.reason));

/* ===== AUDIO (UNCHANGED) ===== */
let audioCtx,noiseSource,gainNode,audioStarted=false;
function startAudio(){
  if(audioStarted) return; audioStarted=true;
  audioCtx=new (window.AudioContext||window.webkitAudioContext)();
  audioCtx.resume();
  const bufferSize=audioCtx.sampleRate*2;
  const buffer=audioCtx.createBuffer(1,bufferSize,audioCtx.sampleRate);
  const data=buffer.getChannelData(0);
  for(let i=0;i<bufferSize;i++) data[i]=Math.random()*2-1;
  noiseSource=audioCtx.createBufferSource(); noiseSource.buffer=buffer; noiseSource.loop=true;
  gainNode=audioCtx.createGain(); gainNode.gain.value=0.015;
  noiseSource.connect(gainNode).connect(audioCtx.destination);
  noiseSource.start();
}
function setNoiseLevel(target){
  if(!gainNode) return;
  gainNode.gain.value += (target - gainNode.gain.value) * 0.02;
}

/* ===== CANVAS PROOF OF LIFE ===== */
const canvas=document.getElementById("c"), ctx=canvas.getContext("2d");
function resize(){canvas.width=innerWidth; canvas.height=innerHeight;}
addEventListener("resize",resize,{passive:true}); resize();
let t0=0;
function draw(t){
  ctx.fillStyle="#000"; ctx.fillRect(0,0,canvas.width,canvas.height);
  // tiny moving dot so we KNOW itâ€™s rendering:
  const x=(canvas.width/2)+Math.sin(t*0.002)*40, y=canvas.height/2;
  ctx.fillStyle="#111"; ctx.fillRect(x,y,2,2);
  requestAnimationFrame(draw);
}

/* ===== START ON TAP ANYWHERE (iOS) ===== */
function begin(){
  document.getElementById("overlay")?.remove();
  try{ startAudio(); }catch(e){ dbg("AUDIO FAIL: "+e.message); }
  requestAnimationFrame(draw);
}
addEventListener("touchstart", begin, {once:true, passive:true});
addEventListener("pointerdown", begin, {once:true});
dbg("loaded ok");
</script>
</body></html>
