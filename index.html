<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Mean</title>
<style>
html, body {
    margin: 0;
    padding: 0;
    background: #000;
    overflow: hidden;
    height: 100%;
}
canvas {
    display: block;
}
#btn {
    position: fixed;
    bottom: 40px;
    left: 50%;
    transform: translateX(-50%);
    padding: 16px 28px;
    border-radius: 22px;
    border: none;
    background: rgba(255,255,255,0.15);
    color: #eee;
    font-size: 16px;
}
</style>
</head>
<body>

<canvas id="c"></canvas>
<button id="btn">Enable Audio</button>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");
const btn = document.getElementById("btn");

function resize() {
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

// ---- AUDIO ----
let audioCtx, osc, gain;
let audioOn = false;

btn.onclick = () => {
    if (audioOn) return;

    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    osc = audioCtx.createOscillator();
    gain = audioCtx.createGain();

    osc.type = "sine";
    osc.frequency.value = 180;          // soft frequency
    gain.gain.value = 0.0001;           // start almost silent

    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();

    audioOn = true;
    btn.textContent = "Audio Enabled";
};

// ---- VISUAL ----
let t = 0;

function draw() {
    t += 0.002;

    const w = canvas.width;
    const h = canvas.height;
    const cx = w / 2;
    const cy = h / 2;

    ctx.fillStyle = "rgba(0,0,0,0.08)";
    ctx.fillRect(0, 0, w, h);

    const breath = 0.5 + 0.5 * Math.sin(t);
    const length = h * (0.35 + 0.05 * breath);
    const width  = 6 + 1.5 * breath;

    const grad = ctx.createLinearGradient(cx, cy - length, cx, cy + length);
    grad.addColorStop(0, "rgba(235,235,235,0)");
    grad.addColorStop(0.5, "rgba(235,235,235,0.9)");
    grad.addColorStop(1, "rgba(235,235,235,0)");

    ctx.strokeStyle = grad;
    ctx.lineWidth = width;
    ctx.lineCap = "round";

    ctx.beginPath();
    ctx.moveTo(cx, cy - length);
    ctx.lineTo(cx, cy + length);
    ctx.stroke();

    // ---- AUDIO MAPPING ----
    if (audioOn && gain) {
        gain.gain.value = 0.01 * breath;   // extremely gentle
    }

    requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>
