<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Specificity</title>
<style>
  html, body { margin:0; height:100%; background:#000; overflow:hidden; touch-action:manipulation; }
  canvas { display:block; }
  #bar {
    position:fixed; left:50%; bottom:18px; transform:translateX(-50%);
    display:flex; gap:10px; align-items:center;
    font-family:system-ui, sans-serif; font-size:12px; color:#777;
    user-select:none;
  }
  button {
    padding:12px 16px; border-radius:14px; border:none;
    background:#777; color:#000; font-size:13px;
  }
</style>
</head>
<body>

<canvas id="c"></canvas>

<div id="bar">
  <button id="audioBtn">Enable Audio</button>
  <button id="micBtn">Enable Mic (turbulence)</button>
</div>

<script>
/* =========================
   CORE STATE
========================= */

// invariant (slow)
let mean = 0.5;
// surface (fast)
let x = 0.5;

// dynamics
let noiseAmp = 0.06;        // baseline turbulence
const pull = 0.03;
const meanDecay = 0.00035;

// stability tracking (non-semantic)
let lastX = x;
let variance = 0;

// time drift (non-semantic)
const t0 = performance.now();

/* =========================
   CANVAS
========================= */

const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
  canvas.width = innerWidth;
  canvas.height = innerHeight;
}
addEventListener("resize", resize);
resize();

/* =========================
   AUDIO (OUTPUT)
========================= */

let audioCtx, noiseNode, gainNode, filterNode;
let audioOn = false;

function startAudio() {
  audioCtx = new (window.AudioContext || window.webkitAudioContext)();
  audioCtx.resume();

  const buffer = audioCtx.createBuffer(1,
