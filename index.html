<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Structure</title>
<style>
  body {
    margin: 0;
    background: black;
    color: white;
    height: 100vh;
    overflow: hidden;
    font-family: system-ui, sans-serif;
  }
  #indicator {
    position: absolute;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 80px;
    height: 80px;
    background: white;
    display: none;
  }
  #controls {
    position: absolute;
    bottom: 20px;
    width: 100%;
    text-align: center;
  }
  button {
    margin: 4px;
    padding: 10px 18px;
    background: #222;
    color: white;
    border: none;
    border-radius: 20px;
  }
</style>
</head>
<body>

<div id="indicator"></div>

<div id="controls">
  <button onclick="mode=0">observe</button>
  <button onclick="mode=1">slideshow</button>
  <button onclick="mode=2">test</button>
  <button onclick="reset()">reset</button>
</div>

<script>
  let S = 0.5;
  const decay = 0.01;
  const perturb = 0.05;
  const threshold = 0.5;

  let mode = 0; // 0 observe, 1 slideshow, 2 test

  const indicator = document.getElementById("indicator");

  function clamp(x) {
    return Math.max(0, Math.min(1, x));
  }

  function tick() {
    S -= decay;
    S = clamp(S);
    indicator.style.display = S > threshold ? "block" : "none";
  }

  setInterval(() => {
    if (mode !== 1) tick();
  }, 1000);

  document.body.addEventListener("pointerdown", () => {
    if (mode === 1) {
      tick();
    } else if (mode === 2) {
      S += (Math.random() < 0.5 ? -1 : 1) * perturb;
      S = clamp(S);
      tick();
    }
  });

  function reset() {
    S = 0.5;
    indicator.style.display = "none";
  }
</script>

</body>
</html>
