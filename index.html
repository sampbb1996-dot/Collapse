<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Signal</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: #000;
  height: 100%;
  overflow: hidden;
  touch-action: manipulation;
}

#overlay {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #aaa;
  font-family: system-ui, sans-serif;
  font-size: 18px;
}

#line {
  position: fixed;
  top: 0;
  left: 50%;
  width: 1px;
  height: 100%;
  background: rgba(255,255,255,0.15);
  transform: translateX(-0.5px);
  opacity: 0;
}
</style>
</head>

<body>

<div id="overlay">tap to begin</div>
<div id="line"></div>

<script>
let started = false;
let ctx, osc, gain;

function startSystem() {
  if (started) return;
  started = true;

  // --- AUDIO (must be inside tap) ---
  ctx = new (window.AudioContext || window.webkitAudioContext)();
  ctx.resume();

  osc = ctx.createOscillator();
  gain = ctx.createGain();

  osc.type = "sine";
  osc.frequency.value = 220;
  gain.gain.value = 0.04;

  osc.connect(gain).connect(ctx.destination);
  osc.start();

  // --- VISUAL ---
  document.getElementById("overlay").remove();
  const line = document.getElementById("line");
  line.style.opacity = 1;

  // subtle drift
  let t = 0;
  function animate() {
    t += 0.002;
    const wobble = Math.sin(t * 3) * 0.6;
    line.style.transform = `translateX(${wobble - 0.5}px)`;
    gain.gain.value = 0.03 + Math.abs(Math.sin(t)) * 0.01;
    requestAnimationFrame(animate);
  }
  animate();
}

document.addEventListener("pointerdown", startSystem, { once: true });
</script>

</body>
</html>
