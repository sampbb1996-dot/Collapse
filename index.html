<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
<title>Collapse</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #050505;
    height: 100%;
    overflow: hidden;
    touch-action: manipulation;
  }

  #field {
    position: absolute;
    inset: 0;
    background: #050505;
  }

  /* stimulus */
  #event {
    position: absolute;
    left: 50%;
    top: 50%;
    width: 2px;
    height: 2px;
    background: #e6e6e6;
    opacity: 0;
    transform: translate(-50%, -50%);
  }
</style>
</head>
<body>

<div id="field"></div>
<div id="event"></div>

<script>
(() => {
  const eventEl = document.getElementById("event");

  let fired = false;
  let armed = false;

  // Random delay window (unpredictable)
  const delay = Math.random() * 100000 + 20000; // 20–120 seconds

  // Arm after user interaction (Safari requirement)
  document.body.addEventListener("touchstart", () => {
    if (!armed) armed = true;
  }, { once: true });

  setTimeout(() => {
    if (!armed) return;

    fired = true;
    eventEl.style.opacity = "1";

    // stimulus exists briefly, then vanishes
    setTimeout(() => {
      eventEl.style.opacity = "0";
      endSession();
    }, 120); // ~1 frame + a bit
  }, delay);

  function endSession() {
    // hard stop — nothing else happens
    document.body.removeEventListener("touchstart", onAction);
    document.body.removeEventListener("touchend", onAction);
  }

  function onAction() {
    if (!fired) return;
    endSession();
  }

  // irreversible micro-action = any tap
  document.body.addEventListener("touchstart", onAction);
  document.body.addEventListener("touchend", onAction);

})();
</script>

</body>
</html>
