<script>
let presence = 0.6
let annotations = []
const tickInterval = 1000

const shape = document.getElementById("shape")
const score = document.getElementById("score")

function evolve() {
  // baseline decay
  presence *= 0.98

  // baseline noise
  presence += (Math.random() - 0.5) * 0.02

  clamp()
  render()
}

function advance(annotation) {
  // interaction = variance only
  presence += (Math.random() - 0.5) * 0.15

  if (annotation !== null) {
    annotations.push(annotation)
    score.textContent = `annotations: ${annotations.length}`
  }

  clamp()
  render()
}

function clamp() {
  presence = Math.max(0.05, Math.min(1, presence))
}

function render() {
  shape.style.opacity = presence
}

document.body.addEventListener("click", e => {
  if (e.target.tagName === "BUTTON") return
  advance(null)
})

document.getElementById("yes").onclick = () => advance(1)
document.getElementById("no").onclick = () => advance(0)

setInterval(evolve, tickInterval)
render()
</script>
