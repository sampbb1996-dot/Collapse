<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>A / Â¬A</title>
<style>
  html, body {
    margin: 0;
    padding: 0;
    background: #2b2b2b; /* soft dark */
    width: 100%;
    height: 100%;
    overflow: hidden;
    touch-action: manipulation;
  }

  #field {
    width: 100%;
    height: 100%;
    background: rgb(80,80,80);
    transition: background 120ms linear;
  }
</style>
</head>
<body>
<div id="field"></div>

<script>
let audioCtx = null;
let osc = null;
let gain = null;

// probability of A being present
let p = 0.5;

// single step update
function tick() {
  // tiny drift toward uncertainty
  p += (Math.random() - 0.5) * 0.02;
  p = Math.min(1, Math.max(0, p));

  // visual
  const intensity = Math.floor(80 + p * 150);
  field.style.background = `rgb(${intensity}, ${intensity*0.8}, 40)`;

  // audio
  if (osc && gain) {
    osc.frequency.value = 200 + p * 600;
    gain.gain.value = 0.05 + p * 0.15;
  }
}

// REQUIRED: user gesture
document.body.addEventListener("pointerdown", () => {
  if (!audioCtx) {
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();

    osc = audioCtx.createOscillator();
    gain = audioCtx.createGain();

    osc.type = "sine";
    osc.frequency.value = 400;
    gain.gain.value = 0;

    osc.connect(gain).connect(audioCtx.destination);
    osc.start();

    audioCtx.resume();
  }

  tick();
});
</script>
</body>
</html>
