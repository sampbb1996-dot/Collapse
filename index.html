<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Mean / Noise</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: black;
    overflow: hidden;
    touch-action: manipulation;
  }

  canvas {
    display: block;
  }

  #audioBtn {
    position: fixed;
    bottom: 28px;
    left: 50%;
    transform: translateX(-50%);
    padding: 14px 22px;
    border-radius: 18px;
    border: none;
    background: #222;
    color: #ddd;
    font-size: 16px;
  }
</style>
</head>
<body>

<canvas id="c"></canvas>
<button id="audioBtn">Enable Audio</button>

<script>
const canvas = document.getElementById("c");
const ctx = canvas.getContext("2d");

function resize() {
  // CSS size
  const w = window.innerWidth;
  const h = window.innerHeight;

  // Device pixel ratio
  const dpr = window.devicePixelRatio || 1;

  // Backing store
  canvas.width = w * dpr;
  canvas.height = h * dpr;

  // Visual size
  canvas.style.width = w + "px";
  canvas.style.height = h + "px";

  // SINGLE scaling (this is the fix)
  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
}

window.addEventListener("resize", resize);
resize();

// ---- DRAW LOOP ----

function draw() {
  const w = canvas.width / (window.devicePixelRatio || 1);
  const h = canvas.height / (window.devicePixelRatio || 1);

  ctx.clearRect(0, 0, w, h);

  const cx = w / 2;
  const cy = h / 2;

  const lineLength = h * 0.65;
  const lineWidth = Math.max(6, w * 0.015);

  const y1 = cy - lineLength / 2;
  const y2 = cy + lineLength / 2;

  // Gradient fade to infinity
  const grad = ctx.createLinearGradient(cx, y1, cx, y2);
  grad.addColorStop(0.0, "rgba(255,255,255,0)");
  grad.addColorStop(0.15, "rgba(255,255,255,0.25)");
  grad.addColorStop(0.5, "rgba(255,255,255,0.85)");
  grad.addColorStop(0.85, "rgba(255,255,255,0.25)");
  grad.addColorStop(1.0, "rgba(255,255,255,0)");

  ctx.strokeStyle = grad;
  ctx.lineWidth = lineWidth;
  ctx.lineCap = "round";

  ctx.beginPath();
  ctx.moveTo(cx, y1);
  ctx.lineTo(cx, y2);
  ctx.stroke();

  requestAnimationFrame(draw);
}

draw();

// ---- AUDIO PLACEHOLDER (SAFE) ----
document.getElementById("audioBtn").onclick = () => {
  // intentionally empty for now
  document.getElementById("audioBtn").textContent = "Audio Enabled";
};
</script>

</body>
</html>
